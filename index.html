<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Camera System</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="ui.css" />
    <script src="ui.js"></script>
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
  </head>
  <body>
    <div id="mode-selector">
      <button id="client-mode-btn" class="mode-btn active">View Mode (Server)</button>
      <button id="camera-mode-btn" class="mode-btn">Camera Mode</button>
    </div>

    <!-- Client Mode Interface (Server) -->
    <div id="client-interface" class="interface-container">
      <div class="connection-panel">
        <div class="server-id-container">
          <h2>Your View ID: <span id="client-id">Generating...</span></h2>
          <button id="copy-client-id">Copy ID</button>
          <button id="generate-new-id">Generate New ID</button>
        </div>
        <div class="status-container">
          <p>Status: <span id="client-connection-status">Waiting for cameras...</span></p>
          <p>Latency: <span id="client-connection-latency">-- ms</span></p>
        </div>
        <div class="view-controls">
          <button id="fullscreen-btn">Enter Fullscreen</button>
        </div>
      </div>

      <div class="connection-info">
        <h3>Connected Cameras:</h3>
        <ul id="connected-cameras-list">
          <li>No cameras connected</li>
        </ul>
      </div>

      <div id="client-view-container">
        <div id="immersive-view">
          <video id="client-front-view" autoplay playsinline></video>
          <video id="client-back-view" autoplay playsinline></video>
          <div class="warning-text">Objects are closer than they appear</div>
        </div>
      </div>
    </div>

    <!-- Camera Mode Interface -->
    <div id="camera-interface" class="interface-container hidden">
      <div class="connection-panel">
        <div class="connect-container">
          <input type="text" id="view-id-input" placeholder="Enter View ID" />
          <button id="connect-camera-btn">Connect Camera</button>
        </div>
        <div class="status-container">
          <p>Status: <span id="camera-connection-status">Disconnected</span></p>
          <p>Latency: <span id="camera-connection-latency">-- ms</span></p>
        </div>
      </div>

      <div class="camera-container">
        <div class="camera-view">
          <h3>Camera Preview</h3>
          <video id="camera-preview" autoplay muted playsinline></video>
        </div>
      </div>

      <div class="camera-settings">
        <div class="camera-select-container">
          <label for="camera-select">Camera:</label>
          <select id="camera-select">
            <option value="">Loading cameras...</option>
          </select>
        </div>
        <div class="camera-role-container">
          <label>Camera Role:</label>
          <div class="role-buttons">
            <button id="front-camera-role" class="role-btn active">Front Camera</button>
            <button id="back-camera-role" class="role-btn">Back Camera</button>
          </div>
        </div>
        <button id="apply-camera-settings">Apply Camera Settings</button>
      </div>
    </div>

    <div id="camera-permission" class="permission-overlay hidden">
      <div class="permission-dialog">
        <h2>Camera Access Required</h2>
        <p>Please allow access to your camera to use this application.</p>
        <button id="grant-permission">Grant Access</button>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>